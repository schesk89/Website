---
title: "SQL"
output: html_document
---
 
## Filtering Columns and Rows

Finding all the Yankees that hit greater than 40 homeruns we could write the following code


```{r warning=FALSE,message=FALSE}
library(Lahman)
library(sqldf)
query<-"SELECT playerID,teamID,yearID,HR FROM Batting
WHERE teamID='NYA' and HR>=40"

sqldf(query)
```


Suppose we wanted to find all the stances where a player had more than 40 homeruns but less than 60 strikeouts

```{r warning=FALSE,message=FALSE}
library(Lahman)
library(sqldf)

query<-"SELECT playerID,yearID,teamID,HR,SO FROM Batting
WHERE HR>40 and SO<60"

sqldf(query)

```

Suppose we wanted to find an instances of Phillies in the the 1970s hitting more than 30 Homeruns.  We would do this in the following way.

```{r}
query<-"SELECT playerID,yearID,teamID,HR FROM Batting
WHERE teamID='PHI' and HR>30 and yearID>=1970 and yearID<=1980"

sqldf(query)


```


With SQL, you can also order the rows in the output.  For example, suppose you wanted to see evrey instance of a player hitting more than 50 homeruns.  But you would like the players with the most homeruns to be at the top of this list.  We would do this in the following way.

```{r}
query<-"SELECT playerID,yearID,teamID,HR FROM Batting
WHERE HR>50
ORDER BY HR DESC"

sqldf(query)
```
